(function(t){function e(e){for(var n,s,c=e[0],i=e[1],u=e[2],d=0,m=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&m.push(o[s][0]),o[s]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);l&&l(e);while(m.length)m.shift()();return a.push.apply(a,u||[]),r()}function r(){for(var t,e=0;e<a.length;e++){for(var r=a[e],n=!0,c=1;c<r.length;c++){var i=r[c];0!==o[i]&&(n=!1)}n&&(a.splice(e--,1),t=s(s.s=r[0]))}return t}var n={},o={app:0},a=[];function s(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=n,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(r,n,function(e){return t[e]}.bind(null,n));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=i;a.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"219b":function(t,e,r){},2395:function(t,e,r){},"34da":function(t,e,r){},"46aa":function(t,e,r){"use strict";r("34da")},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("el-container",[r("el-main",[r("el-row",[r("el-col",[r("router-view")],1)],1)],1)],1)],1)},a=[],s=(r("7c55"),r("2877")),c={},i=Object(s["a"])(c,o,a,!1,null,null,null),u=i.exports,l=r("8c4f"),d=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"login"},[r("el-row",[r("el-col",[r("login-form")],1)],1)],1)},m=[],p=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"login-form"},[r("el-form",{ref:"loginForm",attrs:{rules:t.rules,model:t.loginForm}},[r("el-form-item",{attrs:{label:"Username",prop:"username"}},[r("el-input",{attrs:{type:"text",id:"loginFormUsername",placeholder:"John"},model:{value:t.loginForm.username,callback:function(e){t.$set(t.loginForm,"username",e)},expression:"loginForm.username"}})],1),r("el-form-item",{attrs:{label:"Password",prop:"password"}},[r("el-input",{attrs:{type:"password",id:"loginFormPassword",placeholder:"Doe"},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit(t.loginForm,"loginForm")}}},[t._v("Login")])],1)],1)],1)},f=[],h={name:"login-form",components:{},props:[],data:function(){return{loginForm:{username:"",password:""},rules:{username:[{min:0,max:20,message:"Length should be 0 to 20",trigger:"blur"},{required:!0,message:"Please input Username",trigger:"blur"}],password:[{min:0,max:20,message:"Length should be 0 to 20",trigger:"blur"},{required:!0,message:"Please input Password",trigger:"blur"}]}}},computed:{},mounted:function(){},methods:{onSubmit:function(t,e){var r=this;this.$refs[e].validate((function(e){if(!e)return!1;r.$store.dispatch("login",t)}))}}},b=h,g=(r("6fc9"),Object(s["a"])(b,p,f,!1,null,"6de9f457",null)),y=g.exports,v={name:"login",components:{loginForm:y},props:[],data:function(){return{}},computed:{},mounted:function(){},methods:{}},k=v,w=(r("e0af"),Object(s["a"])(k,d,m,!1,null,"f1f9c056",null)),F=w.exports,P=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"products"},[r("el-row",{attrs:{gutter:30}},[r("el-col",{attrs:{xs:24,md:16}},[r("el-row",[r("el-col",[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[t._v("Search products")])]),r("div",[r("search-form")],1)])],1)],1),r("el-row",{staticClass:"margin-top--lg"},[r("el-col",[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[t._v("Searched results")])]),r("div",[r("search-results")],1)])],1)],1)],1),r("el-col",{attrs:{xs:24,md:8}},[r("el-row",[r("el-col",[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[t._v("Cart")])]),r("div",[r("basket")],1)])],1)],1)],1)],1)],1)},C=[],O=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"search-results"},[r("el-table",{staticStyle:{width:"100%"},attrs:{"empty-text":"No results","header-cell-style":{textAlign:"center"},"cell-style":{textAlign:"center"},data:t.searchedProducts}},[r("el-table-column",{attrs:{prop:"name",label:"Name"}}),r("el-table-column",{attrs:{prop:"description",label:"Description"}}),r("el-table-column",{attrs:{prop:"type",label:"Type"}}),r("el-table-column",{attrs:{label:"Quantity"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-input-number",{attrs:{size:"mini",min:0,max:10},model:{value:e.row.quantity,callback:function(r){t.$set(e.row,"quantity",r)},expression:"scope.row.quantity"}})]}}])}),r("el-table-column",{attrs:{label:"Add to cart"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{disabled:0===e.row.quantity,size:"mini",type:"primary",icon:"el-icon-plus",circle:""},on:{click:function(r){return t.addToCart(e.row)}}})]}}])})],1)],1)},x=[],S=r("5530"),j=r("2f62"),I={name:"search-results",components:{},props:[],data:function(){return{}},computed:Object(S["a"])({},Object(j["b"])({searchedProducts:"products/getSearchResults"})),mounted:function(){},methods:{addToCart:function(t){this.$store.dispatch("basket/addProductToCart",t)}}},_=I,L=(r("f1f5"),Object(s["a"])(_,O,x,!1,null,null,null)),T=L.exports,$=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"search-form"},[r("el-form",{ref:"searchForm",staticClass:"demo-form-inline",attrs:{rules:t.rules,inline:!0,model:t.searchForm}},[r("el-form-item",{attrs:{label:"Product name",prop:"name"}},[r("el-input",{attrs:{clearable:"",type:"text",placeholder:"Type a product's name"},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1),r("el-form-item",{attrs:{label:"Product type",prop:"type"}},[r("el-select",{attrs:{clearable:"",placeholder:"Select type"},model:{value:t.searchForm.type,callback:function(e){t.$set(t.searchForm,"type",e)},expression:"searchForm.type"}},t._l(t.types,(function(t){return r("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit(t.searchForm,"searchForm")}}},[t._v("Search")])],1)],1)],1)},q=[],A=(r("99af"),r("7db0"),r("d81d"),r("5c96")),R=r.n(A),E={composeString:function(){var t="",e=0;for(e;e<arguments.length;e++){var r=e<0||arguments.length<=e?void 0:arguments[e];t="".concat(t).concat(r)}return t},isInputFilled:function(t){return!!t},isItemInList:function(t){var e=t.list,r=t.item,n=t.currentItemProp,o=t.targetItemProp;return e.find((function(t){return t[o]===r[n]}))},showNotification:function(t){Object(A["Notification"])(t)},isOnlyAlphabeticCharacters:function(t){return/^[a-zA-Z ]+$/.test(t)},parseFirebaseFetchedData:function(t){return t.docs.map((function(t){return Object(S["a"])({id:t.id},t.data())}))}},U={onlyLettersAllowed:function(t,e,r){""==e||E.isOnlyAlphabeticCharacters(e)?r():r(new Error("Please input only letters"))}},D={name:"search-form",components:{},props:[],data:function(){return{searchForm:{name:"",type:""},rules:{name:[{validator:U.onlyLettersAllowed,trigger:"blur"},{min:0,max:30,message:"Length should be 0 to 30",trigger:"blur"}]}}},computed:Object(S["a"])({},Object(j["b"])({types:"products/getTypes"})),mounted:function(){},methods:{onSubmit:function(t,e){var r=this;this.$refs[e].validate((function(e){if(!e)return!1;r.$store.dispatch("products/searchProducts",t)}))}}},N=D,z=(r("46aa"),Object(s["a"])(N,$,q,!1,null,"d4290a6a",null)),Q=z.exports,B=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"basket"},[r("el-table",{staticStyle:{width:"100%"},attrs:{"empty-text":"No products in the cart","header-cell-style":{textAlign:"center"},"cell-style":{textAlign:"center"},data:t.basketList}},[r("el-table-column",{attrs:{prop:"name",label:"Name"}}),r("el-table-column",{attrs:{prop:"quantity",label:"Quantity"}}),r("el-table-column",{attrs:{label:"Remove"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-minus",circle:""},on:{click:function(r){return t.removeFromCart(e.row)}}})]}}])})],1)],1)},M=[],J={name:"basket",components:{},props:[],data:function(){return{}},computed:Object(S["a"])({},Object(j["b"])({basketList:"basket/getBasketList"})),mounted:function(){},methods:{removeFromCart:function(t){this.$store.dispatch("basket/removeProductFromCart",t)}}},W=J,K=(r("9608"),Object(s["a"])(W,B,M,!1,null,"1590e153",null)),G=K.exports,V={name:"products",components:{searchResults:T,searchForm:Q,basket:G},props:[],data:function(){return{}},computed:{},mounted:function(){this.$store.dispatch("basket/fetchDataFromCart")},methods:{}},Z=V,X=(r("b7e5"),Object(s["a"])(Z,P,C,!1,null,"06d021ce",null)),Y=X.exports,H={idToken:"",idUser:""},tt={setIdToken:function(t,e){t.idToken=e},setIdUser:function(t,e){t.idUser=e}},et=(r("bf19"),r("260b")),rt=(r("ea7b"),r("e71f"),{apiKey:"AIzaSyAnYQuIVfMXZW_-nVkO7DS7OjRQ4WO2Kts",authDomain:"search-and-buy.firebaseapp.com",databaseURL:"https://search-and-buy-default-rtdb.firebaseio.com",projectId:"search-and-buy",storageBucket:"search-and-buy.appspot.com",messagingSenderId:"648869467094",appId:"1:648869467094:web:84de59c909add3e3daca77"});et["a"].initializeApp(rt);var nt=et["a"].firestore(),ot=et["a"].auth(),at=(nt.collection("products"),{LOGIN:"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=".concat(rt.apiKey)}),st=r("bc3a"),ct=r.n(st),it={loginRequest:function(t){return ct.a.post(at["LOGIN"],{email:t.username,password:t.password,returnSecureToken:!0})},manageRequestError:function(t){var e=t.toJSON(),r="Request failed with status code 400";if(e.message==r){var n={title:"Error",type:"error",message:"Username or Password not valid. Please try again"};E.showNotification(n)}else{var o={title:"Error",type:"error",message:"Oops...something went wrong"};E.showNotification(o)}}},ut={login:function(t,e){var r=t.commit,n=Object(S["a"])({},e);n.username=E.composeString(e.username,"@rs2.com"),it.loginRequest(n).then((function(t){var e=t.data.idToken,n=t.data.localId;r("setIdToken",e),r("setIdUser",n)})).then((function(){It.push({name:"products"})})).catch((function(t){it.manageRequestError(t)}))}},lt={getLoginData:function(t){return t.loginForm},getIdToken:function(t){return t.idToken},getIdUser:function(t){return t.idUser},isAuthenticated:function(t){return!!t.idToken}},dt={state:H,getters:lt,mutations:tt,actions:ut},mt={types:["books","games","music"],searchResults:[],basketList:[]},pt=r("2909"),ft=(r("4de4"),{setSearchResults:function(t,e){t.searchResults=Object(pt["a"])(e)},addProductToCart:function(t,e){t.basketList.push(e)},removeProductFromCart:function(t,e){var r=e.product,n=e.basketList,o=Object(pt["a"])(n);t.basketList=o.filter((function(t){return t.id!==r.id}))}}),ht=(r("b0c0"),{setQuery:function(t){var e=t.name,r=t.type,n=nt.collection("products");return E.isInputFilled(t.type)&&(n=n.where("type","==",r)),E.isInputFilled(t.name)&&(n=n.where("name","==",e)),n},searchProductsRequest:function(t){var e=this.setQuery(t);return e.get()}}),bt={searchProducts:function(t,e){var r=t.commit;ht.searchProductsRequest(e).then((function(t){var e=E.parseFirebaseFetchedData(t);r("setSearchResults",e)}))}},gt={getTypes:function(t){return t.types},getSearchResults:function(t){return t.searchResults.map((function(t){return Object.assign({},t,{quantity:0})}))},getBasketList:function(t){return t.basketList}},yt={namespaced:!0,state:mt,getters:gt,mutations:ft,actions:bt},vt={basketList:[]},kt={addProductsToCart:function(t,e){var r=Object(pt["a"])(t.basketList);t.basketList=r.concat(e)},removeProductFromCart:function(t,e){var r=e.productId,n=Object(pt["a"])(t.basketList);t.basketList=n.filter((function(t){return t.id!==r}))}},wt={fetchDataFromCart:function(t){return nt.collection("users").doc(t).collection("basket").get()},addProductToCart:function(t,e){return nt.collection("users").doc(e).collection("basket").add(t)},removeProductFromCart:function(t,e){return nt.collection("users").doc(e).collection("basket").doc(t).delete()}},Ft={fetchDataFromCart:function(t){var e=t.commit,r=t.rootState,n=r.authentication.idUser;wt.fetchDataFromCart(n).then((function(t){var r=E.parseFirebaseFetchedData(t);r.length>0&&e("addProductsToCart",r)}))},addProductToCart:function(t,e){var r=t.commit,n=t.getters,o=t.rootState,a=E.isItemInList({list:n.getBasketList,item:e,currentItemProp:"id",targetItemProp:"productId"});if(a){var s={title:"Warning",type:"warning",message:"Product already present in the cart"};E.showNotification(s)}else{var c=o.authentication.idUser,i={productId:e.id,userId:c,quantity:e.quantity,name:e.name};wt.addProductToCart(i,c).then((function(t){i.id=t.id,r("addProductsToCart",[i])}))}},removeProductFromCart:function(t,e){var r=t.commit,n=t.rootState,o=e.id,a=n.authentication.idUser;wt.removeProductFromCart(o,a).then((function(){r("removeProductFromCart",{productId:o})})).catch((function(t){console.error("Error removing document: ",t)}))}},Pt={getBasketList:function(t){return t.basketList}},Ct={namespaced:!0,state:vt,getters:Pt,mutations:kt,actions:Ft};n["default"].use(j["a"]);var Ot=new j["a"].Store({state:{},getters:{},mutations:{},actions:{},modules:{authentication:dt,products:yt,basket:Ct}});n["default"].use(l["a"]);var xt=[{path:"/login",name:"login",component:F},{path:"/products",name:"products",component:Y,meta:{requiresAuth:!0}},{path:"/",redirect:"/login"}],St=new l["a"]({routes:xt});St.beforeEach((function(t,e,r){t.meta.requiresAuth&&!Ot.getters.isAuthenticated?r("/login"):r()}));var jt,It=St,_t=r("2106"),Lt=r.n(_t),Tt=r("b2d6"),$t=r.n(Tt);r("0fae"),r("3d5b"),r("6e0c");n["default"].use(j["a"]),n["default"].use(Lt.a,ct.a),n["default"].use(R.a,{locale:$t.a}),n["default"].config.productionTip=!1,ot.onAuthStateChanged((function(){jt||(jt=new n["default"]({router:It,store:Ot,render:function(t){return t(u)}}).$mount("#app"))}))},"6e0c":function(t,e,r){},"6fc9":function(t,e,r){"use strict";r("7973")},7973:function(t,e,r){},"7c55":function(t,e,r){"use strict";r("2395")},9608:function(t,e,r){"use strict";r("f79f")},a592:function(t,e,r){},b7e5:function(t,e,r){"use strict";r("a592")},b844:function(t,e,r){},e0af:function(t,e,r){"use strict";r("219b")},f1f5:function(t,e,r){"use strict";r("b844")},f79f:function(t,e,r){}});
//# sourceMappingURL=app.579b9ccf.js.map